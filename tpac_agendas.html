<!DOCTYPE html>

<html lang="en-US">

<head>
  <meta charset="utf-8">
  <title>Agendas for TPAC meetings</title>
  <meta name="author" content="W3C">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/x-icon" href="//www.w3.org/favicon.ico">
  <style>
    .warning { font-weight: bold; }
    li { margin-top: 0.5ex;}
  </style>
</head>

<body>

  <h1>Agendas for <span id="calname">TPAC meetings</span></h1>

  <h2 id="warning">Meeting without agendas</h2>
  <p>Chairs and Team Contacts should update the calendar entries to add the meeting agenda (or where the agenda is discussed in the meantime).</p>
  <ul id="mevents">

  </ul>

  <h2 id="ok">Meeting with agendas</h2>
  <p>The following meetings have an agenda (some maybe be in draft state):</p>
  <ul id="oevents">

  </ul>
  <script>
// create an element easily
// attrs is object (and optional)
// content is Element or string
function text(str) {
  return document.createTextNode(str);
}
function domElement(namespaceURI, name, attrs, ...content) {
  const elt = document.createElementNS(namespaceURI, name);
  const makeChild = c => (c instanceof Element) ?
    c : (typeof c === 'string') ?
      text(c) : undefined;

  if (attrs) {
    const c = makeChild(attrs);
    if (c) {
      elt.appendChild(c);
    } else {
      for (const [name, value] of Object.entries(attrs)) {
        elt.setAttribute(name, value);
      }
    }
  }
  for (const child of content) {
    if (child instanceof Element) {
      elt.appendChild(child);
    } else {
      elt.appendChild(text(child));
    }
  }
  return elt;
}
function htmlElement(name, attrs, ...content) {
  return domElement("http://www.w3.org/1999/xhtml", name, attrs, ...content);
}
function svgElement(name, attrs, ...content) {
  return domElement("http://www.w3.org/2000/svg", name, attrs, ...content);
}
</script>

<script type="module">
    import loadICS from './ics.js';
    const MEV = document.getElementById('mevents');
    const OEV = document.getElementById('oevents');
    let year = (new URL(document.location)).searchParams.get("year");
    if (!year) year = '2024';
    loadICS(`https://www.w3.org/calendar/tpac${year}/export/`).then(calendar => {
      document.getElementById('calname').textContent = calendar.name;
      calendar.events.forEach(ev => {
        let ul = OEV;
        const li = htmlElement('li',
          text(ev.dtstart.substring(0, ev,dtstart.indexOf('T')) + " -- " + ev.summary),
          htmlElement('br')
        );
        if (ev.agenda) {
          li.appendChild(htmlElement('a', { href: ev.html_url, 'class': 'ok' }, "agenda"))
        } else if (ev.agenda_url) {
          li.appendChild(htmlElement('a', { href: ev.agenda_url, 'class': 'ok' }, "agenda"))
        } else if (ev.description) {
          li.appendChild(htmlElement('a', { href: ev.agenda_url, 'class': 'ok' }, "description"))
        } else {
          ul = MEV;
        }
        li.appendChild(text(", "));
        li.appendChild(htmlElement('a', { href: ev.html_url + 'edit/' }, "edit"))
        ul.appendChild(li);
      })
    }).catch(console.error);

  </script>

<hr>
<a href='https://github.com/w3c/gargantua/'>It's on GitHub</a>
</body>

</html>
